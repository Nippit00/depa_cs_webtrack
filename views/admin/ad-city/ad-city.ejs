<!DOCTYPE html>
<html lang="en">
<head>
    
    <title>
        Admin - <%= pageTitle %>
    </title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wdth,wght@62.5..100,100..900&display=swap" rel="stylesheet">
</head>
   <style>
 
    *{
  font-family: "Noto Sans Thai", sans-serif;
  font-optical-sizing: auto;
  font-weight: 400; /* Replace with the desired font weight */
  font-style: normal;
  font-variation-settings:
    "wdth" 100;
}

   </style>

<body>
    <%- include('../include/ad-navbar.ejs') %>
    
    <div class="w-[90%] mx-auto mt-5 overflow-x-auto">
            <table class="min-w-full bg-white shadow-md rounded-lg overflow-hidden">
              <thead class="bg-gray-200 ">
                <tr>
                  <th class="py-2 px-4">‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏°‡∏∑‡∏≠‡∏á</th>
                  <th class="py-2 px-4">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
                  <th class="py-2 px-4">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                  <th class="py-2 px-4">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤</th>
                  <th class="py-2 px-4">‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</th>
                  <th class="py-2 px-4">‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏±‡∏ê</th>
                  <th class="py-2 px-4">‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô</th>
                </tr>
              </thead>
              <tbody>
                <% cityData.forEach(city => { %>
                  <tr onclick="check('<%= city.cityID %>')" class="hover:bg-gray-200 hover:border-[1px] border-black">
                    <td class="py-2 px-4 border-1 border-r border-l"><%= city.cityID %></td>
                    <td class="py-2 px-4 border-1 border-r border-l"><%= city.province %></td>
                    <td class="py-2 px-4 border-1 border-r border-l"><%= city.date %></td>
                    <td class="py-2 px-4 break-words border-1 border-r border-l"><%= city.developer %></td>
                    <td class="py-2 px-4 break-words border-1 border-r border-l"><%= city.executive %></td>
                    <td class="py-2 px-4 text-center border-1 border-r border-l">
                      <% if (city.government_investment === 0) { %>
                        ‚ùåüßÄ
                      <% } else { %>
                        <%= city.government_investment.toLocaleString() %> ‡∏ö‡∏≤‡∏ó
                      <% } %>
                    </td>
                    <td class="py-2 px-4 text-center border-1 border-r border-l">
                      <% if (city.private_investment === 0) { %>
                        üçª
                      <% } else { %>
                        <%= city.private_investment.toLocaleString() %> ‡∏ö‡∏≤‡∏ó
                      <% } %>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
      </div>
      
      
    

    <%- include('../include/ad-footer.ejs') %>
</body>
<script>
    function check(cityID){
        // href=`/city/${cityID}`
        window.location.href = `/admin/city/${cityID}`;
    }
</script>
<script>
  const search = document.getElementById('searchInput');

  search.addEventListener("keyup", (event) => {
      const searchTerm = event.target.value.toLowerCase();
      console.log(searchTerm)
      
      // const filteredData = cityData.filter(city => {
      //     return (
      //         city.cityID.toLowerCase().includes(searchTerm) ||
      //         city.province.toLowerCase().includes(searchTerm) ||
      //         city.developer.toLowerCase().includes(searchTerm) ||
      //         city.executive.toLowerCase().includes(searchTerm)
      //     );
      // });
      const cityData=[]
      <% cityData.forEach(city => { %>
        
          if(
            '<%=city.cityID%>'.toLowerCase().includes(searchTerm) ||
            '<%=city.province%>'.toLowerCase().includes(searchTerm) ||
            '<%=city.developer%>'.toLowerCase().includes(searchTerm) ||
            '<%=city.executive%>'.toLowerCase().includes(searchTerm)){
                cityData.push('<%=city%>')
                console.log(cityData[0])
              }
        <%})%>
    
      // renderTable(cityData);
  });

  function renderTable(filteredData) {
      const tableBody = document.querySelector('#cityTable tbody');
      tableBody.innerHTML = '';

      filteredData.forEach(city => {
          const row = document.createElement('tr');
          row.onclick = function() {
              check(city.cityID);
          };

          const cells = [
              city.cityID,
              city.province,
              city.date.toISOString().slice(0, 10),
              city.developer,
              city.executive,
              city.government_investment === 0 ? "‚ùåüßÄ" : `${city.government_investment.toLocaleString()} ‡∏ö‡∏≤‡∏ó`,
              city.private_investment === 0 ? "‚ùåü•ê" : `${city.private_investment.toLocaleString()} ‡∏ö‡∏≤‡∏ó`
          ];

          cells.forEach(cellData => {
              const cell = document.createElement('td');
              cell.className = "py-2 px-4 break-words border-1 border-r border-l";
              cell.textContent = cellData;
              row.appendChild(cell);
          });

          tableBody.appendChild(row);
      });
  }

  // Initial render of the table with all city data
  // renderTable(cityData);
</script>
</html>
